{{define "pagination"}}
{{if .}}
<div class="pagination" id="pagination-section">
    <!-- Información de la paginación -->
    <div class="pagination-info">
        <p class="text-sm text-gray-700">
            Mostrando página <span class="font-medium">{{.CurrentPage}}</span> de <span class="font-medium">{{.TotalPages}}</span>
            {{if .TotalItems}}
                (<span class="font-medium">{{.TotalItems}}</span> noticias total)
            {{end}}
        </p>
    </div>
    
    <!-- Navegación de páginas -->
    <nav class="pagination-nav" aria-label="Navegación de páginas">
        <!-- Botón Anterior -->
                        <button 
                    type="button"
                    onclick="navigateToPageWithParams({{.PrevPage}})"
                    {{if not .HasPrev}}disabled{{end}}
                    class="pagination-btn {{if not .HasPrev}}opacity-50 cursor-not-allowed{{end}}"
                    aria-label="Página anterior"
                >
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            Anterior
        </button>
        
        <!-- Números de página -->
        {{$currentPage := .CurrentPage}}
        {{$totalPages := .TotalPages}}
        
        <!-- Primera página -->
        {{if gt $currentPage 3}}
            <button 
                type="button"
                onclick="goToPage(1)"
                class="pagination-btn"
                aria-label="Ir a página 1"
            >
                1
            </button>
            
            {{if gt $currentPage 4}}
                <span class="px-2 py-2 text-sm text-gray-500">...</span>
            {{end}}
        {{end}}
        
        <!-- Páginas alrededor de la actual -->
        {{range $i := .PageRange}}
            <button 
                type="button"
                onclick="navigateToPageWithParams({{$i}})"
                class="pagination-btn {{if eq $i $currentPage}}active{{end}}"
                aria-label="Ir a página {{$i}}"
                {{if eq $i $currentPage}}aria-current="page"{{end}}
            >
                {{$i}}
            </button>
        {{end}}
        
        <!-- Última página -->
        {{if and (gt $totalPages 5) (lt $currentPage $totalPages)}}
            {{if lt $currentPage $totalPages}}
                <span class="px-2 py-2 text-sm text-gray-500">...</span>
            {{end}}
            
            <button 
                type="button"
                onclick="navigateToPageWithParams({{$totalPages}})"
                class="pagination-btn"
                aria-label="Ir a página {{$totalPages}}"
            >
                {{$totalPages}}
            </button>
        {{end}}
        
        <!-- Botón Siguiente -->
                        <button 
                    type="button"
                    onclick="navigateToPageWithParams({{.NextPage}})"
                    {{if not .HasNext}}disabled{{end}}
                    class="pagination-btn {{if not .HasNext}}opacity-50 cursor-not-allowed{{end}}"
                    aria-label="Página siguiente"
                >
            Siguiente
            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
        </button>
    </nav>
    
    <!-- Salto rápido a página -->
    <div class="hidden md:flex items-center space-x-2 text-sm">
        <label for="page-jump" class="text-gray-600">Ir a página:</label>
        <input 
            type="number" 
            id="page-jump-input"
            min="1" 
            max="{{.TotalPages}}" 
            value="{{.CurrentPage}}"
            class="w-16 px-2 py-1 text-center border border-gray-300 rounded focus:border-blue-500 focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"
            onkeypress="onPageJumpKeypress(event)"
            aria-label="Número de página"
        >
        <button 
            type="button"
            onclick="navigateToPageWithParams(document.getElementById('page-jump-input').value)"
            class="btn btn-secondary text-xs px-2 py-1"
        >
            Ir
        </button>
    </div>
</div>

<!-- Script para funcionalidad de paginación -->
<script>
// Función para navegar a una página preservando TODOS los parámetros (como navigateWithLang)
function navigateToPageWithParams(page) {
    console.log('🚀 navigateToPageWithParams() ejecutada con página:', page);
    
    // Obtener todos los parámetros actuales
    const currentParams = new URLSearchParams(window.location.search);
    
    // Actualizar solo el parámetro de página
    currentParams.set('page', page.toString());
    
    // Construir la nueva URL preservando TODOS los parámetros
    const newUrl = window.location.pathname + '?' + currentParams.toString();
    
    console.log('URL final:', newUrl);
    window.location.href = newUrl;
}

// Configurar data attributes cuando el DOM esté listo
document.addEventListener('DOMContentLoaded', function() {
    const paginationElement = document.getElementById('pagination-section');
    if (paginationElement) {
        paginationElement.setAttribute('data-current-page', '{{.CurrentPage}}');
        paginationElement.setAttribute('data-total-pages', '{{.TotalPages}}');
        paginationElement.setAttribute('data-has-prev', '{{.HasPrev}}');
        paginationElement.setAttribute('data-has-next', '{{.HasNext}}');
    }
});
</script>
{{end}}
{{end}}