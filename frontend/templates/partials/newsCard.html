{{define "newsCard"}}
<div class="news-card bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 overflow-hidden flex flex-col h-full">
    <!-- Imagen de la noticia -->
    <div class="news-image-container relative">
        {{if .Image}}
            <img 
                src="{{.Image}}" 
                alt="{{.Title}}"
                class="news-image w-full h-48 object-cover"
                loading="lazy"
                onerror="this.src='/images/error.webp'"
            >
        {{else}}
            <div class="news-placeholder w-full h-48 bg-gray-200 flex items-center justify-center">
                <svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
            </div>
        {{end}}
        
        <!-- Badge de fuente (esquina superior derecha) -->
        <div class="absolute top-2 right-2">
            <span class="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-600 text-white shadow-sm">
                {{if eq .SourceName "El País Cultura"}}El País{{else if eq .SourceName "El País Gente"}}El País{{else if eq .SourceName "ABC Cultura Música"}}ABC{{else if eq .SourceName "ABC Series"}}ABC{{else if eq .SourceName "ABC Alimentación"}}ABC{{else if eq .SourceName "ABC Tecnología"}}ABC{{else if eq .SourceName "ABC Deportes"}}ABC{{else if eq .SourceName "ABC Economía"}}ABC{{else if eq .SourceName "ABC Internacional"}}ABC{{else if eq .SourceName "El País Deportes"}}El País{{else if eq .SourceName "El País Economía"}}El País{{else if eq .SourceName "El País Tecnología"}}El País{{else if eq .SourceName "El País Internacional"}}El País{{else if eq .SourceName "El País Salud"}}El País{{else if eq .SourceName "El País Entretenimiento"}}El País{{else if eq .SourceName "El País Cultura"}}El País{{else if eq .SourceName "Expansión Portada"}}Expansión{{else if eq .SourceName "France24 Internacional"}}France24{{else if eq .SourceName "La Vanguardia Internacional"}}La Vanguardia{{else if eq .SourceName "Mejor con Salud"}}Mejor con Salud{{else}}{{.SourceName}}{{end}}
            </span>
        </div>
    </div>
    
    <!-- Contenido de la noticia -->
    <div class="news-content p-4 flex flex-col flex-1">
        <!-- Título -->
        <h3 class="news-title text-lg font-semibold text-gray-900 mb-3 line-clamp-3">
            <a href="{{.Link}}" target="_blank" rel="noopener noreferrer" onclick="trackNewsClick('{{.ID}}', '{{.SourceName}}', '{{.CategoryName}}')" class="hover:text-blue-600 transition-colors">
                {{.Title}}
            </a>
        </h3>
        
        <!-- Footer: fecha (izquierda) + copiar enlace (derecha) -->
        <div class="flex items-center justify-between mt-auto">
            <!-- Fecha formateada -->
            <div class="news-date text-xs text-gray-500">
                <time datetime="{{.PubDate}}" class="flex items-center" data-date="{{.PubDate}}">
                    <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                    </svg>
                    <span class="formatted-date">
                        {{if .PubDate}}
                            {{.PubDate}}
                        {{else}}
                            Reciente
                        {{end}}
                    </span>
                </time>
            </div>

            <!-- Copiar/compartir enlace (derecha) -->
            <div class="relative inline-block overflow-visible">
                <button
                    type="button"
                    class="copy-link-btn inline-flex items-center justify-center w-7 h-7 rounded-full bg-gray-700/10 hover:bg-gray-700/20 text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white transition-all duration-150 active:scale-95"
                    aria-label="Copiar enlace de la noticia"
                    title="Copiar enlace"
                    onclick="copyNewsLink('{{.Link}}', this)">
                    <!-- Icono copiar (estilo móvil: documentos superpuestos - outline) -->
                    <svg class="w-4 h-4" viewBox="0 0 512 512" fill="none" stroke="currentColor" stroke-width="32" stroke-linejoin="round" aria-hidden="true">
                        <rect x="128" y="128" width="336" height="336" rx="57" ry="57"></rect>
                        <path d="M383.5 128l.5-24a56.16 56.16 0 00-56-56h-208a56.16 56.16 0 00-56 56v208a56.16 56.16 0 0056 56h24"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>
</div>
{{end}}